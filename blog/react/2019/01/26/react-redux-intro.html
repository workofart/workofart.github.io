<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.5.0 -->
<title>React Redux Intro | Henry’s Blog</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="React Redux Intro" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="I’ve been bugged by the native state management system in React that I finally had to take a stab at Redux. Here are some notes I took along the way to understand what Redux is and why we need it." />
<meta property="og:description" content="I’ve been bugged by the native state management system in React that I finally had to take a stab at Redux. Here are some notes I took along the way to understand what Redux is and why we need it." />
<link rel="canonical" href="http://henrypan.com/blog/react/2019/01/26/react-redux-intro.html" />
<meta property="og:url" content="http://henrypan.com/blog/react/2019/01/26/react-redux-intro.html" />
<meta property="og:site_name" content="Henry’s Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-01-26T12:00:00-05:00" />
<script type="application/ld+json">
{"url":"http://henrypan.com/blog/react/2019/01/26/react-redux-intro.html","description":"I’ve been bugged by the native state management system in React that I finally had to take a stab at Redux. Here are some notes I took along the way to understand what Redux is and why we need it.","dateModified":"2019-01-26T12:00:00-05:00","datePublished":"2019-01-26T12:00:00-05:00","headline":"React Redux Intro","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://henrypan.com/blog/react/2019/01/26/react-redux-intro.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/blog/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://henrypan.com/blog/feed.xml" title="Henry's Blog" /><script>
if(!(window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1")) {
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-103622213-1', 'auto');
  ga('send', 'pageview');
}
</script>
  
</head>
<body><header class="site-header" role="banner">
    <div class="wrapper"><a class="site-title" rel="author" href="/blog/">Henry&#39;s Blog</a><nav class="site-nav">
          <input type="checkbox" id="nav-trigger" class="nav-trigger" />
          <label for="nav-trigger">
            <span class="menu-icon">
              <svg viewBox="0 0 18 15" width="18px" height="15px">
                <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
              </svg>
            </span>
          </label>
  
          <div class="trigger">
            <a class="page-link" href="http://henrypan.com">Homepage</a>
            <!---->
          </div>
        </nav></div>
  </header>
  <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">React Redux Intro</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2019-01-26T12:00:00-05:00" itemprop="datePublished">Jan 26, 2019
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>I’ve been bugged by the native state management system in React that I finally had to take a stab at Redux. Here are some notes I took along the way to understand what Redux is and why we need it.</p>

<p>First off, why do we need Redux when we already have build-in states? Isn’t this just more boilerplate code? What’s the return on investment?</p>

<p>The short answer is it depends on the lifecycle of the data being stored in the state. In other words:</p>

<p><img src="/blog/assets/images/react_redux/painpoint.png" alt="Pain Point" /></p>

<p>Let’s see how this might be a problem. There are cases where mismanaged states could cause chaos. For example:
<img src="/blog/assets/images/react_redux/painpoint2.png" alt="Pain Point" /></p>

<p>If Dropdown 1’s options wants to be conditionally dependant on Dropdown 2’s state or vice versa or both. And since props can only be passed from top to bottom, the only way either Dropdown knows the value of its sibling is to ask it’s parent (container). This means every action either dropdown invokes, it has to invoke an actionHandler at the parent level which sets the state for the other child which is then passed down to the child as a prop. This approach doesn’t scale well. Below is an example snippet of how this might be troublesome.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">Dropdown1</span> <span class="kd">extends</span> <span class="nx">Component</span> <span class="p">{</span>
  
  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">select</span> <span class="nx">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">handler</span><span class="p">(</span><span class="nx">e</span><span class="p">)}</span> <span class="nx">style</span><span class="o">=&gt;</span>
      <span class="c1">//... various options</span>
      <span class="o">&lt;</span><span class="sr">/select</span><span class="err">&gt;
</span>    <span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="kd">class</span> <span class="nx">Dropdown2</span> <span class="kd">extends</span> <span class="nx">Component</span> <span class="p">{</span>
  
  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">select</span> <span class="nx">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">handler</span><span class="p">(</span><span class="nx">e</span><span class="p">)}</span> <span class="nx">style</span><span class="o">=&gt;</span>
      <span class="c1">//... various options</span>
      <span class="o">&lt;</span><span class="sr">/select</span><span class="err">&gt;
</span>    <span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="kd">class</span> <span class="nx">Form</span> <span class="kd">extends</span> <span class="nx">Component</span> <span class="p">{</span>
  <span class="nx">state</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">dropdown1Active</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="na">dropdown2Active</span><span class="p">:</span> <span class="kc">true</span>
  <span class="p">}</span>
  <span class="nx">handleAction1</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="na">dropdown2Active</span><span class="p">:</span> <span class="kc">false</span><span class="p">})</span>
  <span class="p">}</span>
  <span class="nx">handleAction2</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="na">dropdown1Active</span><span class="p">:</span> <span class="kc">false</span><span class="p">})</span>
  <span class="p">}</span>
  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">Dropdown1</span> <span class="nx">handler</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleAction1</span><span class="p">}</span> <span class="nx">isActive</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">dropdown1Active</span><span class="p">}</span><span class="sr">/</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="nx">Dropdown2</span> <span class="nx">handler</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleAction2</span><span class="p">}</span> <span class="nx">isActive</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">dropdown2Active</span><span class="p">}</span><span class="sr">/</span><span class="err">&gt;
</span>    <span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Wouldn’t it be great if each child’s action can directly change the centralized state of a particular field without always going through the parent and all other children will know right away? That’s the simplified idea of Redux.</p>

<hr />

<p>Before we go into the details of Redux, here are some commonly used terms that I’ll refer extensively in my notes.</p>

<p><strong>Store{Object}</strong>—The centralized state storage. One instance exists at any given time; therefore, states that pertain to particular components will be stored under separate “keys”.</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Fetch the current store contents</span>
<span class="nx">store</span><span class="p">.</span><span class="nx">getState</span><span class="p">()</span>
<span class="c1">// returns </span>
<span class="p">{</span>
  <span class="nl">todo</span><span class="p">:</span> <span class="p">[{</span> <span class="na">id</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="na">text</span><span class="p">:</span> <span class="s2">"test"</span> <span class="p">}],</span>
  <span class="nx">counter</span><span class="p">:</span> <span class="p">{</span> <span class="nl">currentNumber</span><span class="p">:</span> <span class="mi">0</span> <span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<p><strong>Reducer{Function}</strong>—Given the current state and action, returns the next state. This reminds me of the Markov Decision Process. Therefore, this function will contain the logic on how to update the states. By default, it will return the initial state <code class="highlighter-rouge">currentNum: 0</code> if no action is provided. Similar to calling <code class="highlighter-rouge">this.state</code> in plain React. Always remember not to modify the state directly but to return a copy of the state <code class="highlighter-rouge">{…state, currentNum: state.currentNum+1}</code>(this is ES6 syntax).</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// actions.js</span>
<span class="kd">function</span> <span class="nx">counter</span> <span class="p">(</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span> <span class="na">currentNum</span><span class="p">:</span> <span class="mi">0</span> <span class="p">},</span> <span class="nx">action</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">switch</span> <span class="p">(</span><span class="nx">action</span><span class="p">.</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">case</span> <span class="s1">'INCREMENT'</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{...</span><span class="nx">state</span><span class="p">,</span>
                <span class="na">currentNum</span><span class="p">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">currentNum</span><span class="o">+</span><span class="mi">1</span>
            <span class="p">}</span>
        <span class="k">case</span> <span class="s1">'DECREMENT'</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{...</span><span class="nx">state</span><span class="p">,</span> 
                <span class="na">currentNum</span><span class="p">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">currentNum</span><span class="o">-</span><span class="mi">1</span>
            <span class="p">}</span>
        <span class="nl">default</span><span class="p">:</span>
            <span class="k">return</span> <span class="nx">state</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>The process:</strong>
Define the reducer like above
Create the store for a particular (or set of) reducers. You can include multiple reducers for a given store by using the <code class="highlighter-rouge">combineReducers</code> function provided by Redux. Using <code class="highlighter-rouge">combineReducers</code> will essentially combine multiple reducers into one reducer object, which saves the effort of redefining a parent reducer object.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// App.js</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">createStore</span><span class="p">,</span> <span class="nx">combineReducers</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'redux'</span><span class="p">;</span>
<span class="cm">/**
 * The keys used here will be the keys in the redux store
 * E.g.
 * {
 *    "todos": [],
 *    "counter": {
 *      "currentNum": 0
 *    },
 *    "filter": "SHOW_ALL"
 * }
 */</span>
<span class="kd">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">combineReducers</span><span class="p">({</span>
  <span class="nx">todos</span><span class="p">,</span>
  <span class="nx">counter</span><span class="p">,</span>
  <span class="nx">filter</span>
<span class="p">})</span>
<span class="kd">const</span> <span class="nx">store</span> <span class="o">=</span> <span class="nx">createStore</span><span class="p">(</span><span class="nx">app</span><span class="p">);</span>
</code></pre></div></div>

<ol>
  <li>Have the presentational components subscribe to the changes of the store to know when to re-render. This step could be replaced by <code class="highlighter-rouge">connect()</code> from <code class="highlighter-rouge">react-redux</code> package, which basically wraps around the component and all children under it will have access to the <code class="highlighter-rouge">store</code> instead of passing the <code class="highlighter-rouge">store</code> to every child that needs access to it. (Not explained in this note)</li>
</ol>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// index.js</span>
<span class="k">import</span> <span class="nx">App</span><span class="p">,</span> <span class="p">{</span> <span class="nx">store</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'./App'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">render</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">App</span> <span class="o">/&gt;</span><span class="p">,</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'root'</span><span class="p">));</span>
<span class="p">}</span>
<span class="nx">store</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">render</span><span class="p">);</span> <span class="c1">// invokes render whenever the store changes, essentially pushing render into an array of listeners</span>
</code></pre></div></div>

<ol>
  <li>In the presentational components, reference the store and the contents that it’s interested in <code class="highlighter-rouge">counter.currentNum</code></li>
</ol>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">store</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'./App'</span><span class="p">;</span>

<span class="o">&lt;</span><span class="nx">h3</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">store</span><span class="p">.</span><span class="nx">getState</span><span class="p">().</span><span class="nx">counter</span><span class="p">.</span><span class="nx">currentNum</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/h3</span><span class="err">&gt;
</span>
</code></pre></div></div>
<ol>
  <li>Fire off an action from a button to dispatch a particular action for the reducer function to process</li>
</ol>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">button</span>
  <span class="nx">onClick</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span>
    <span class="nx">store</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">({</span>
      <span class="na">type</span><span class="p">:</span> <span class="s2">"INCREMENT"</span>
    <span class="p">})</span>
  <span class="p">}</span>
<span class="o">&gt;</span>
  <span class="o">+</span>
<span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span></code></pre></div></div>
<p>The “INCREMENT” action gets dispatched by the store to the reducer. In the reducer, the action and the current state gets processed by the logic, which then returns the next state <code class="highlighter-rouge">{currentNum: state.currentNum + 1}</code></p>

<p>You can find a working example <a href="https://github.com/workofart/playground/tree/master/react">here</a> that demonstrates and compares React Redux and Component State usage.</p>

  </div><a class="u-url" href="/blog/react/2019/01/26/react-redux-intro.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/blog/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Henry&#39;s Blog</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Henry&#39;s Blog</li><li><a class="u-email" href="mailto:hanxiangp@gmail.com">hanxiangp@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/workofart"><svg class="svg-icon"><use xlink:href="/blog/assets/minima-social-icons.svg#github"></use></svg> <span class="username">workofart</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>My learning notes, research, projects and musings.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
